GAS LISTING /tmp/cc2pNJEa.s 			page 1


   1              		.file	"Riscv.cpp"
   2              		.option pic
   3              		.option norelax
   4              		.text
   5              	.Ltext0:
   6              		.align	2
   7              		.globl	_ZN5Riscv16setupTrapHandlerEv
   9              	_ZN5Riscv16setupTrapHandlerEv:
  10              	.LFB0:
  11              		.file 1 "src/Riscv.cpp"
   1:src/Riscv.cpp **** //
   2:src/Riscv.cpp **** // Created by os on 10/7/25.
   3:src/Riscv.cpp **** //
   4:src/Riscv.cpp **** 
   5:src/Riscv.cpp **** #include "../h/Riscv.hpp"
   6:src/Riscv.cpp **** #include "../lib/hw.h"
   7:src/Riscv.cpp **** 
   8:src/Riscv.cpp **** constexpr uint64 MEM_ALLOC = 0x01;
   9:src/Riscv.cpp **** constexpr uint64 MEM_FREE = 0x02;
  10:src/Riscv.cpp **** constexpr uint64 MEM_GET_FREE_SPACE = 0x03;
  11:src/Riscv.cpp **** constexpr uint64 MEM_GET_LARGEST_FREE_BLOCK = 0x04;
  12:src/Riscv.cpp **** 
  13:src/Riscv.cpp **** void Riscv::setupTrapHandler() {
  12              		.loc 1 13 32
  13              		.cfi_startproc
  14 0000 130101FF 		addi	sp,sp,-16
  15              		.cfi_def_cfa_offset 16
  16 0004 23348100 		sd	s0,8(sp)
  17              		.cfi_offset 8, -8
  18 0008 13040101 		addi	s0,sp,16
  19              		.cfi_def_cfa 8, 0
  14:src/Riscv.cpp ****     unsigned long addr = (unsigned long)&trap_handler;
  20              		.loc 1 14 5
  21              		.loc 1 14 19 is_stmt 0
  22 000c 97070000 		la	a5,trap_handler
  22      83B70700 
  23              	.LVL0:
  15:src/Riscv.cpp ****     asm volatile("csrw stvec, %0" :: "r"(addr));
  24              		.loc 1 15 5 is_stmt 1
  25              		.loc 1 15 48 is_stmt 0
  26              	#APP
  27              	# 15 "src/Riscv.cpp" 1
  16              	}
  28              		csrw stvec, a5
  29              	# 0 "" 2
  30              		.loc 1 16 1
  31              	#NO_APP
  32 0018 03348100 		ld	s0,8(sp)
  33              		.cfi_restore 8
  34              		.cfi_def_cfa 2, 16
  35 001c 13010101 		addi	sp,sp,16
  36              		.cfi_def_cfa_offset 0
  37 0020 67800000 		jr	ra
  38              		.cfi_endproc
  39              	.LFE0:
  41              		.align	2
  42              		.globl	_ZN5Riscv11trapHandlerEv
GAS LISTING /tmp/cc2pNJEa.s 			page 2


  44              	_ZN5Riscv11trapHandlerEv:
  45              	.LFB1:
  17:src/Riscv.cpp **** 
  18:src/Riscv.cpp **** void Riscv::trapHandler() {
  46              		.loc 1 18 27 is_stmt 1
  47              		.cfi_startproc
  48 0024 130101FF 		addi	sp,sp,-16
  49              		.cfi_def_cfa_offset 16
  50 0028 23348100 		sd	s0,8(sp)
  51              		.cfi_offset 8, -8
  52 002c 13040101 		addi	s0,sp,16
  53              		.cfi_def_cfa 8, 0
  19:src/Riscv.cpp ****     uint64 scause = 0, sepc = 0;
  54              		.loc 1 19 5
  55              	.LVL1:
  20:src/Riscv.cpp ****     asm volatile("csrr %0, scause" : "=r"(scause));
  56              		.loc 1 20 5
  57              		.loc 1 20 51 is_stmt 0
  58              	#APP
  59              	# 20 "src/Riscv.cpp" 1
  21              	    asm volatile("csrr %0, sepc" : "=r"(sepc));
  60              		csrr a4, scause
  61              	# 0 "" 2
  62              	.LVL2:
  63              		.loc 1 21 5 is_stmt 1
  64              		.loc 1 21 47 is_stmt 0
  65              	# 21 "src/Riscv.cpp" 1
  22              	
  66              		csrr a3, sepc
  67              	# 0 "" 2
  68              	.LVL3:
  23:src/Riscv.cpp ****     uint64 interrupt = scause >> 63;
  69              		.loc 1 23 5 is_stmt 1
  24:src/Riscv.cpp ****     uint64 cause = scause & 0x7FFFFFFFFFFFFFFF;
  70              		.loc 1 24 5
  71              		.loc 1 24 12 is_stmt 0
  72              	#NO_APP
  73 0038 9307F0FF 		li	a5,-1
  74 003c 93D71700 		srli	a5,a5,1
  75 0040 B377F700 		and	a5,a4,a5
  76              	.LVL4:
  25:src/Riscv.cpp **** 
  26:src/Riscv.cpp ****     if (interrupt == 0 && cause == 9) {
  77              		.loc 1 26 5 is_stmt 1
  78              	.LBB2:
  79 0044 63460700 		bltz	a4,.L3
  80              		.loc 1 26 24 is_stmt 0 discriminator 1
  81 0048 13079000 		li	a4,9
  82              	.LVL5:
  83 004c 6388E700 		beq	a5,a4,.L6
  84              	.LVL6:
  85              	.L3:
  86              	.LBE2:
  27:src/Riscv.cpp ****         uint64 code;
  28:src/Riscv.cpp ****         asm volatile("mv %0, a0" : "=r"(code));
  29:src/Riscv.cpp **** 
  30:src/Riscv.cpp ****         switch (code) {
GAS LISTING /tmp/cc2pNJEa.s 			page 3


  31:src/Riscv.cpp **** 
  32:src/Riscv.cpp ****         }
  33:src/Riscv.cpp **** 
  34:src/Riscv.cpp ****         sepc += 4;
  35:src/Riscv.cpp ****         asm volatile("csrw sepc, %0" :: "r"(sepc));
  36:src/Riscv.cpp ****     }
  37:src/Riscv.cpp **** }
  87              		.loc 1 37 1
  88 0050 03348100 		ld	s0,8(sp)
  89              		.cfi_remember_state
  90              		.cfi_restore 8
  91              		.cfi_def_cfa 2, 16
  92 0054 13010101 		addi	sp,sp,16
  93              		.cfi_def_cfa_offset 0
  94 0058 67800000 		jr	ra
  95              	.LVL7:
  96              	.L6:
  97              		.cfi_restore_state
  98              	.LBB4:
  99              	.LBB3:
  27:src/Riscv.cpp ****         uint64 code;
 100              		.loc 1 27 9 is_stmt 1
  28:src/Riscv.cpp **** 
 101              		.loc 1 28 9
  28:src/Riscv.cpp **** 
 102              		.loc 1 28 47 is_stmt 0
 103              	#APP
 104              	# 28 "src/Riscv.cpp" 1
 105              		mv a5, a0
 106              	# 0 "" 2
 107              	.LVL8:
  30:src/Riscv.cpp **** 
 108              		.loc 1 30 9 is_stmt 1
  34:src/Riscv.cpp ****         asm volatile("csrw sepc, %0" :: "r"(sepc));
 109              		.loc 1 34 9
  34:src/Riscv.cpp ****         asm volatile("csrw sepc, %0" :: "r"(sepc));
 110              		.loc 1 34 14 is_stmt 0
 111              	#NO_APP
 112 0060 93864600 		addi	a3,a3,4
 113              	.LVL9:
  35:src/Riscv.cpp ****     }
 114              		.loc 1 35 9 is_stmt 1
  35:src/Riscv.cpp ****     }
 115              		.loc 1 35 51 is_stmt 0
 116              	#APP
 117              	# 35 "src/Riscv.cpp" 1
 118              		csrw sepc, a3
 119              	# 0 "" 2
 120              	#NO_APP
 121              	.LBE3:
 122              	.LBE4:
 123              		.loc 1 37 1
 124 0068 6FF09FFE 		j	.L3
 125              		.cfi_endproc
 126              	.LFE1:
 128              	.Letext0:
 129              		.file 2 "src/../h/Riscv.hpp"
GAS LISTING /tmp/cc2pNJEa.s 			page 4


 130              		.file 3 "src/../lib/hw.h"
GAS LISTING /tmp/cc2pNJEa.s 			page 5


DEFINED SYMBOLS
                            *ABS*:0000000000000000 Riscv.cpp
     /tmp/cc2pNJEa.s:9      .text:0000000000000000 _ZN5Riscv16setupTrapHandlerEv
     /tmp/cc2pNJEa.s:13     .text:0000000000000000 .L0 
     /tmp/cc2pNJEa.s:14     .text:0000000000000000 .L0 
     /tmp/cc2pNJEa.s:15     .text:0000000000000004 .L0 
     /tmp/cc2pNJEa.s:17     .text:0000000000000008 .L0 
     /tmp/cc2pNJEa.s:19     .text:000000000000000c .L0 
     /tmp/cc2pNJEa.s:21     .text:000000000000000c .L0 
     /tmp/cc2pNJEa.s:22     .text:000000000000000c .L0 
     /tmp/cc2pNJEa.s:25     .text:0000000000000014 .L0 
       src/Riscv.cpp:15     .text:0000000000000014 .L0 
     /tmp/cc2pNJEa.s:32     .text:0000000000000018 .L0 
     /tmp/cc2pNJEa.s:33     .text:000000000000001c .L0 
     /tmp/cc2pNJEa.s:34     .text:000000000000001c .L0 
     /tmp/cc2pNJEa.s:36     .text:0000000000000020 .L0 
     /tmp/cc2pNJEa.s:38     .text:0000000000000024 .L0 
     /tmp/cc2pNJEa.s:44     .text:0000000000000024 _ZN5Riscv11trapHandlerEv
     /tmp/cc2pNJEa.s:47     .text:0000000000000024 .L0 
     /tmp/cc2pNJEa.s:48     .text:0000000000000024 .L0 
     /tmp/cc2pNJEa.s:49     .text:0000000000000028 .L0 
     /tmp/cc2pNJEa.s:51     .text:000000000000002c .L0 
     /tmp/cc2pNJEa.s:53     .text:0000000000000030 .L0 
     /tmp/cc2pNJEa.s:56     .text:0000000000000030 .L0 
     /tmp/cc2pNJEa.s:57     .text:0000000000000030 .L0 
       src/Riscv.cpp:20     .text:0000000000000030 .L0 
     /tmp/cc2pNJEa.s:64     .text:0000000000000034 .L0 
       src/Riscv.cpp:21     .text:0000000000000034 .L0 
     /tmp/cc2pNJEa.s:70     .text:0000000000000038 .L0 
     /tmp/cc2pNJEa.s:71     .text:0000000000000038 .L0 
     /tmp/cc2pNJEa.s:73     .text:0000000000000038 .L0 
     /tmp/cc2pNJEa.s:79     .text:0000000000000044 .L0 
     /tmp/cc2pNJEa.s:81     .text:0000000000000048 .L0 
     /tmp/cc2pNJEa.s:88     .text:0000000000000050 .L0 
     /tmp/cc2pNJEa.s:89     .text:0000000000000054 .L0 
     /tmp/cc2pNJEa.s:90     .text:0000000000000054 .L0 
     /tmp/cc2pNJEa.s:91     .text:0000000000000054 .L0 
     /tmp/cc2pNJEa.s:93     .text:0000000000000058 .L0 
     /tmp/cc2pNJEa.s:97     .text:000000000000005c .L0 
     /tmp/cc2pNJEa.s:101    .text:000000000000005c .L0 
     /tmp/cc2pNJEa.s:102    .text:000000000000005c .L0 
       src/Riscv.cpp:28     .text:000000000000005c .L0 
     /tmp/cc2pNJEa.s:109    .text:0000000000000060 .L0 
     /tmp/cc2pNJEa.s:110    .text:0000000000000060 .L0 
     /tmp/cc2pNJEa.s:112    .text:0000000000000060 .L0 
     /tmp/cc2pNJEa.s:115    .text:0000000000000064 .L0 
       src/Riscv.cpp:35     .text:0000000000000064 .L0 
     /tmp/cc2pNJEa.s:124    .text:0000000000000068 .L0 
     /tmp/cc2pNJEa.s:125    .text:000000000000006c .L0 
     /tmp/cc2pNJEa.s:131    .text:000000000000006c .L0 
     /tmp/cc2pNJEa.s:22     .text:000000000000000c .L0 
     /tmp/cc2pNJEa.s:85     .text:0000000000000050 .L3
     /tmp/cc2pNJEa.s:96     .text:000000000000005c .L6
     /tmp/cc2pNJEa.s:370    .debug_abbrev:0000000000000000 .Ldebug_abbrev0
     /tmp/cc2pNJEa.s:751    .debug_str:000000000000017e .LASF31
     /tmp/cc2pNJEa.s:759    .debug_str:0000000000000272 .LASF32
     /tmp/cc2pNJEa.s:731    .debug_str:00000000000000d8 .LASF33
GAS LISTING /tmp/cc2pNJEa.s 			page 6


     /tmp/cc2pNJEa.s:5      .text:0000000000000000 .Ltext0
     /tmp/cc2pNJEa.s:128    .text:000000000000006c .Letext0
     /tmp/cc2pNJEa.s:695    .debug_line:0000000000000000 .Ldebug_line0
     /tmp/cc2pNJEa.s:739    .debug_str:0000000000000119 .LASF34
     /tmp/cc2pNJEa.s:755    .debug_str:0000000000000251 .LASF0
     /tmp/cc2pNJEa.s:741    .debug_str:000000000000011f .LASF2
     /tmp/cc2pNJEa.s:711    .debug_str:0000000000000050 .LASF1
     /tmp/cc2pNJEa.s:763    .debug_str:000000000000029b .LASF3
     /tmp/cc2pNJEa.s:699    .debug_str:000000000000000a .LASF4
     /tmp/cc2pNJEa.s:749    .debug_str:000000000000016b .LASF5
     /tmp/cc2pNJEa.s:735    .debug_str:0000000000000102 .LASF6
     /tmp/cc2pNJEa.s:725    .debug_str:00000000000000b4 .LASF8
     /tmp/cc2pNJEa.s:719    .debug_str:0000000000000079 .LASF7
     /tmp/cc2pNJEa.s:709    .debug_str:0000000000000049 .LASF9
     /tmp/cc2pNJEa.s:723    .debug_str:00000000000000a1 .LASF10
     /tmp/cc2pNJEa.s:747    .debug_str:0000000000000158 .LASF11
     /tmp/cc2pNJEa.s:757    .debug_str:0000000000000262 .LASF12
     /tmp/cc2pNJEa.s:705    .debug_str:000000000000002c .LASF13
     /tmp/cc2pNJEa.s:707    .debug_str:000000000000003a .LASF14
     /tmp/cc2pNJEa.s:753    .debug_str:0000000000000242 .LASF15
     /tmp/cc2pNJEa.s:713    .debug_str:000000000000005c .LASF16
     /tmp/cc2pNJEa.s:703    .debug_str:000000000000001c .LASF17
     /tmp/cc2pNJEa.s:733    .debug_str:00000000000000f6 .LASF18
     /tmp/cc2pNJEa.s:743    .debug_str:000000000000013d .LASF19
     /tmp/cc2pNJEa.s:721    .debug_str:000000000000008b .LASF20
     /tmp/cc2pNJEa.s:729    .debug_str:00000000000000ce .LASF21
     /tmp/cc2pNJEa.s:737    .debug_str:0000000000000110 .LASF22
     /tmp/cc2pNJEa.s:727    .debug_str:00000000000000bb .LASF23
     /tmp/cc2pNJEa.s:761    .debug_str:0000000000000280 .LASF24
     /tmp/cc2pNJEa.s:45     .text:0000000000000024 .LFB1
     /tmp/cc2pNJEa.s:126    .text:000000000000006c .LFE1
     /tmp/cc2pNJEa.s:717    .debug_str:0000000000000072 .LASF25
     /tmp/cc2pNJEa.s:635    .debug_loc:0000000000000000 .LLST0
     /tmp/cc2pNJEa.s:745    .debug_str:0000000000000153 .LASF26
     /tmp/cc2pNJEa.s:647    .debug_loc:0000000000000037 .LLST1
     /tmp/cc2pNJEa.s:697    .debug_str:0000000000000000 .LASF27
     /tmp/cc2pNJEa.s:659    .debug_loc:000000000000006e .LLST2
     /tmp/cc2pNJEa.s:715    .debug_str:000000000000006c .LASF28
     /tmp/cc2pNJEa.s:671    .debug_loc:0000000000000096 .LLST3
     /tmp/cc2pNJEa.s:99     .text:000000000000005c .LBB3
     /tmp/cc2pNJEa.s:121    .text:0000000000000068 .LBE3
     /tmp/cc2pNJEa.s:765    .debug_str:00000000000002b4 .LASF29
     /tmp/cc2pNJEa.s:10     .text:0000000000000000 .LFB0
     /tmp/cc2pNJEa.s:39     .text:0000000000000024 .LFE0
     /tmp/cc2pNJEa.s:701    .debug_str:0000000000000017 .LASF30
     /tmp/cc2pNJEa.s:55     .text:0000000000000030 .LVL1
     /tmp/cc2pNJEa.s:62     .text:0000000000000034 .LVL2
     /tmp/cc2pNJEa.s:82     .text:000000000000004c .LVL5
     /tmp/cc2pNJEa.s:68     .text:0000000000000038 .LVL3
     /tmp/cc2pNJEa.s:76     .text:0000000000000044 .LVL4
     /tmp/cc2pNJEa.s:84     .text:0000000000000050 .LVL6
     /tmp/cc2pNJEa.s:95     .text:000000000000005c .LVL7
     /tmp/cc2pNJEa.s:107    .text:0000000000000060 .LVL8
     /tmp/cc2pNJEa.s:132    .debug_info:0000000000000000 .Ldebug_info0

UNDEFINED SYMBOLS
trap_handler
GAS LISTING /tmp/cc2pNJEa.s 			page 7


